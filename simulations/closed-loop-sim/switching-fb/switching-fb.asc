Version 4
SHEET 1 2468 1448
WIRE -448 112 -464 112
WIRE -224 112 -448 112
WIRE 544 112 -128 112
WIRE 608 112 544 112
WIRE 864 112 688 112
WIRE 1072 112 864 112
WIRE 1216 112 1072 112
WIRE 1344 112 1216 112
WIRE -464 144 -464 112
WIRE 544 192 544 112
WIRE 864 192 864 112
WIRE 16 208 -64 208
WIRE 80 208 16 208
WIRE -208 240 -208 160
WIRE 80 256 80 208
WIRE 1216 272 1216 112
WIRE -64 336 -64 208
WIRE 544 336 544 256
WIRE 864 336 864 256
WIRE -464 352 -464 224
WIRE 80 384 80 336
WIRE 80 384 0 384
WIRE -208 448 -208 240
WIRE -64 448 -64 432
WIRE -64 448 -208 448
WIRE 640 464 512 464
WIRE 800 464 704 464
WIRE 832 464 800 464
WIRE 944 464 912 464
WIRE 1072 464 1072 112
WIRE 1072 464 1008 464
WIRE -64 480 -64 448
WIRE 160 496 160 464
WIRE 304 560 304 544
WIRE 512 560 512 464
WIRE 560 560 512 560
WIRE 688 560 640 560
WIRE 800 560 800 464
WIRE 800 560 752 560
WIRE 880 560 800 560
WIRE 1072 560 1072 464
WIRE 1072 560 960 560
WIRE 480 576 336 576
WIRE -64 592 -64 544
WIRE 16 592 -64 592
WIRE 80 592 80 384
WIRE 80 592 16 592
WIRE 160 592 160 576
WIRE 272 592 160 592
WIRE 464 608 336 608
WIRE 512 608 512 560
WIRE 512 608 464 608
WIRE -64 640 -64 592
WIRE 752 640 736 640
WIRE 768 640 752 640
WIRE 1216 640 1216 352
WIRE 304 656 304 624
WIRE 736 672 736 640
WIRE 32 688 0 688
WIRE 160 688 160 592
WIRE 160 688 112 688
WIRE 800 688 800 560
WIRE 800 688 768 688
WIRE 512 704 512 608
WIRE 704 704 512 704
WIRE 0 720 0 688
WIRE 0 720 -16 720
WIRE 848 720 768 720
WIRE 864 720 848 720
WIRE 736 752 736 736
WIRE -64 768 -64 736
WIRE 976 816 880 816
WIRE 1072 816 976 816
WIRE 1072 832 1072 816
WIRE 352 880 -336 880
WIRE 880 880 880 816
WIRE 1072 928 1072 912
WIRE 1072 928 944 928
WIRE -128 960 -176 960
WIRE -16 960 -64 960
WIRE 224 992 208 992
WIRE 288 992 224 992
WIRE 288 1008 288 992
WIRE 1072 1024 1072 928
WIRE -96 1040 -112 1040
WIRE -80 1040 -96 1040
WIRE -112 1072 -112 1040
WIRE 208 1072 208 992
WIRE 880 1072 880 976
WIRE 1008 1072 880 1072
WIRE -336 1088 -336 880
WIRE -288 1088 -336 1088
WIRE -176 1088 -176 960
WIRE -176 1088 -208 1088
WIRE -144 1088 -176 1088
WIRE 144 1088 112 1088
WIRE 176 1088 144 1088
WIRE -16 1104 -16 960
WIRE -16 1104 -80 1104
WIRE 32 1104 -16 1104
WIRE 288 1104 288 1088
WIRE 288 1104 240 1104
WIRE 352 1104 352 880
WIRE 352 1104 288 1104
WIRE -144 1120 -176 1120
WIRE 176 1120 144 1120
WIRE 352 1120 352 1104
WIRE 880 1120 880 1072
WIRE 1072 1152 1072 1120
WIRE 1136 1152 1072 1152
WIRE 1184 1152 1136 1152
WIRE -112 1168 -112 1136
WIRE 208 1168 208 1136
WIRE -256 1184 -272 1184
WIRE -240 1184 -256 1184
WIRE 1072 1200 1072 1152
WIRE -272 1216 -272 1184
WIRE 144 1216 144 1120
WIRE 352 1216 352 1200
WIRE 352 1216 144 1216
WIRE 352 1232 352 1216
WIRE -272 1312 -272 1296
WIRE -192 1312 -272 1312
WIRE -176 1312 -176 1120
WIRE -176 1312 -192 1312
WIRE 32 1312 32 1104
WIRE 96 1312 32 1312
WIRE 352 1312 96 1312
WIRE 480 1312 480 576
WIRE 480 1312 352 1312
WIRE -272 1328 -272 1312
WIRE 880 1360 880 1200
WIRE 1072 1360 1072 1264
FLAG -464 352 0
FLAG 1344 112 vout
FLAG -448 112 vin
FLAG -208 240 pwm
FLAG 1216 640 0
FLAG 304 656 0
FLAG 400 768 0
FLAG 464 608 gain
FLAG 304 544 vin
FLAG 160 464 vin
FLAG 736 752 0
FLAG 752 640 vin
FLAG -64 768 0
FLAG 16 592 vint3
FLAG 544 336 0
FLAG 864 336 0
FLAG 16 208 vin
FLAG 880 1360 0
FLAG 1072 1360 0
FLAG 1136 1152 vref
FLAG 848 720 vref
FLAG 976 816 vin
FLAG -112 1168 0
FLAG -96 1040 vin
FLAG 224 992 vin
FLAG 208 1168 0
FLAG -272 1408 0
FLAG -256 1184 vin
FLAG -192 1312 vc
FLAG 144 1088 vc
FLAG 96 1312 tri
SYMBOL voltage -464 128 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -51 114 Left 2
SYMATTR Value2 AC 0
SYMATTR Value 10
SYMATTR InstName V1
SYMBOL ind 592 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=1e-2
SYMBOL cap 848 192 R0
SYMATTR InstName Cout
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=1e-2
SYMBOL current 1216 272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value PULSE(0.5 1.5 4000u 1u 1u 2000u)
SYMBOL schottky 560 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MBRS340
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 400 672 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -114 136 Left 2
SYMATTR Value PULSE(0.1 10 0 2u 2u 0 4u)
SYMATTR InstName V2
SYMBOL res 144 480 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 976 576 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 27k
SYMBOL res 544 544 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 816 448 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 680
SYMBOL cap 640 448 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 82p
SYMBOL cap 688 544 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL cap 944 448 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL Opamps\\opamp2 304 528 M0
SYMATTR InstName U2
SYMATTR Value LM393A
SYMBOL pmos -128 160 M270
SYMATTR InstName M1
SYMATTR Value Si5515_P
SYMBOL npn 0 336 M0
SYMATTR InstName Q1
SYMATTR Value 2N2222
SYMBOL diode -48 480 M0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 96 240 M0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL nmos -16 640 M0
SYMATTR InstName M2
SYMATTR Value BSS123
SYMBOL res 128 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 33
SYMBOL pnp 944 976 R180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL pnp 1008 1120 M180
SYMATTR InstName Q3
SYMATTR Value 2N3906
SYMBOL res 1088 816 M0
SYMATTR InstName R13
SYMATTR Value 82
SYMBOL res 896 1104 M0
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL diode 1088 1264 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 36 Left 2
SYMATTR InstName D3
SYMATTR Value DI_1N4733A
SYMATTR Prefix X
SYMBOL Opamps\\OP27 736 640 M0
SYMATTR InstName U1
SYMBOL OpAmps\\opamp2 -112 1040 R0
SYMATTR InstName U3
SYMATTR Value TL972
SYMBOL res -192 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 4.7k
SYMBOL cap -64 944 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 200p
SYMBOL res -288 1200 R0
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res -288 1312 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 336 1104 R0
SYMATTR InstName R10
SYMATTR Value 20k
SYMBOL res 336 1216 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL OpAmps\\opamp2 208 1040 R0
SYMATTR InstName U4
SYMATTR Value LM393A
SYMBOL res 272 992 R0
SYMATTR InstName R12
SYMATTR Value 270
TEXT -48 -112 Left 2 !.model SW SW(Ron=0.0001 Vt=2 Vh=-0.1 Roff=1G)
TEXT -48 -80 Left 2 !.model d d ron=0.001 roff=1G vfwd=0.01 vrev=100
TEXT -48 -48 Left 2 ;.ac dec 50 10 100k
TEXT -48 -16 Left 2 !.tran 0 10m 0 startup
TEXT 592 -112 Left 2 !.include ../../TL972.lib
TEXT 592 -80 Left 2 !.include ../../LMC648x.lib
TEXT 592 -48 Left 2 !.include ../../LM393A.lib
TEXT 592 -16 Left 2 !.include ../../spicemodels_zener_diodes.txt
