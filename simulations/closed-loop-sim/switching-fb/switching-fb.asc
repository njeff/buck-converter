Version 4
SHEET 1 1652 1236
WIRE -128 112 -144 112
WIRE 176 112 -128 112
WIRE 544 112 256 112
WIRE 608 112 544 112
WIRE 864 112 688 112
WIRE 1072 112 864 112
WIRE 1216 112 1072 112
WIRE 1344 112 1216 112
WIRE -144 144 -144 112
WIRE 144 176 48 176
WIRE 192 176 192 160
WIRE 192 176 144 176
WIRE 240 176 240 160
WIRE 544 192 544 112
WIRE 864 192 864 112
WIRE 1216 272 1216 112
WIRE -144 336 -144 224
WIRE 544 336 544 256
WIRE 544 336 -144 336
WIRE 864 336 864 256
WIRE 864 336 544 336
WIRE -144 352 -144 336
WIRE 576 464 448 464
WIRE 736 464 640 464
WIRE 768 464 736 464
WIRE 880 464 848 464
WIRE 976 464 944 464
WIRE 1072 464 1072 112
WIRE 1072 464 976 464
WIRE -16 496 -16 464
WIRE 128 560 128 544
WIRE 448 560 448 464
WIRE 496 560 448 560
WIRE 624 560 576 560
WIRE 736 560 736 464
WIRE 736 560 688 560
WIRE 224 576 160 576
WIRE 976 576 976 464
WIRE -16 592 -16 576
WIRE 48 592 48 176
WIRE 48 592 -16 592
WIRE 96 592 48 592
WIRE 272 608 160 608
WIRE 448 608 448 560
WIRE 448 608 272 608
WIRE -16 640 -16 592
WIRE 688 640 672 640
WIRE 704 640 688 640
WIRE 1216 640 1216 352
WIRE 128 656 128 624
WIRE 672 672 672 640
WIRE 224 688 224 576
WIRE 736 688 736 560
WIRE 736 688 704 688
WIRE 976 688 976 656
WIRE 976 688 736 688
WIRE 448 704 448 608
WIRE 640 704 448 704
WIRE 800 720 704 720
WIRE -16 752 -16 704
WIRE 672 752 672 736
WIRE 800 752 800 720
FLAG -144 352 0
FLAG 1344 112 vout
FLAG -128 112 vin
FLAG 144 176 pwm
FLAG 1216 640 0
FLAG 128 656 0
FLAG 240 176 0
FLAG 224 768 0
FLAG 272 608 gain
FLAG 128 544 vin
FLAG -16 464 vin
FLAG 672 752 0
FLAG 688 640 vin
FLAG 800 832 0
FLAG -16 752 0
SYMBOL voltage -144 128 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -214 159 Left 2
SYMATTR Value2 AC 0
SYMATTR Value PWL(0 0 1u 10)
SYMATTR InstName V1
SYMBOL ind 592 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 10µ
SYMATTR SpiceLine Rser=1e-2
SYMBOL cap 848 192 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=1e-2
SYMBOL current 1216 272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value PULSE(0.5 1.5 4000u 1u 1u 2000u)
SYMBOL diode 560 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL sw 272 112 M270
SYMATTR InstName S1
SYMBOL voltage 224 672 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0.1 5 0 5u 1n 0 5u)
SYMBOL res -32 480 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 992 560 M0
SYMATTR InstName R1
SYMATTR Value 31.6k
SYMBOL res 480 544 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL res 752 448 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 5k
SYMBOL cap 576 448 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 150p
SYMBOL cap 624 544 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL cap 880 448 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 3n
SYMBOL voltage 800 736 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 5
SYMBOL OpAmps\\OP27 672 640 M0
SYMATTR InstName U1
SYMBOL Opamps\\opamp2 128 528 M0
SYMATTR InstName U2
SYMATTR Value LM393A
SYMBOL cap -32 640 R0
SYMATTR InstName C5
SYMATTR Value 10p
TEXT -48 -112 Left 2 !.model SW SW(Ron=0.0001 Vt=2 Vh=-0.1 Roff=1G)
TEXT -48 -80 Left 2 !.model d d ron=0.001 roff=1G vfwd=0.01 vrev=100
TEXT -48 -48 Left 2 ;.ac dec 50 10 100k
TEXT -48 -16 Left 2 !.tran 0 10m 0
TEXT 592 -112 Left 2 !.include ../../NE5532.lib
TEXT 592 -80 Left 2 !.include ../../lm2903b.lib
TEXT 592 -48 Left 2 !.include ../../LM393A.lib
